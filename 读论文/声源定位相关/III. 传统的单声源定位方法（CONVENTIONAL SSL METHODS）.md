# III. 传统的单声源定位方法（CONVENTIONAL SSL METHODS）

在深度学习（DL）出现之前，人们发展了一系列的信号处理技术来解决单声源定位（SSL）问题。DiBiase等人（2001）对这些方法进行了详细的回顾。Argentieri等人（2015）则在具体的机器人领域进行了回顾。在本节中，我们简要介绍最常见的传统SSL方法。正如介绍中简要提到的，这样做的原因有两个：首先，传统的SSL方法常常被用作深度学习方法的基准；其次，许多基于深度学习的SSL方法使用传统方法提取的输入特征（见第V节）。

当知道麦克风阵列的几何结构时，可以通过估计麦克风之间源信号的到达时间差（TDoA）来进行方向估计（Xu等，2013）。广义交叉相关（CC）与相位变换（GCC-PHAT）是处理两个麦克风阵列时最常用的方法之一（Knapp和Carter，1976）。它的计算方法是两个麦克风信号的交叉功率谱（CPS）的加权版本的傅里叶逆变换：
$$
r_{1,2}(\tau) = \sum_{f=0}^{F-1}\frac{X1(f)X2(f)^*} {|X1(f)X2(f)|}e^{(j2πfs/N)}
$$

其中，Xi(f) 是麦克风信号xi(t)的N点傅里叶变换，X1(f)X2*(f)是CPS（*表示复共轭）。然后，通过找到最大化GCC-PHAT函数的麦克风信号的时间延迟，可以得到TDoA的估计：
$$
\tau = arg maxs_\tau r_{1,2}(\tau)				
$$

GCC方法已经扩展到了多于两个麦克风的阵列，特别是显示出利用多对麦克风可以改善定位精度（Benesty等人，2008；DiBiase等人，2001）。

生成声源功率地图P(x)，其中x为空间坐标（通常为正则网格），是检索一个或多个声源的方向的另一种方法，因为地图的局部极大值主要对应于声源的方向。Steered-Response Power（SRP）地图已被广泛使用：它在每个候选网格位置上指向延迟和求和波束形成器，并测量来自这些方向的能量。其PHAT版本对混响更为稳健，因此最受欢迎。实际上，它可以从在所有麦克风对上计算的GCC-PHAT的平均值得到（DiBiase等人，2001）：
$$
P(x) = \sum_{m_1=1}^{M} \sum_{m_2=m_1+1}^{M} r1,2(\tau m_1,m_2(x))，(7)
$$
其中sm1;m2(x)是麦克风m₁和m₂之间与空间位置x相关联的延迟。

除了建立基于声源定位概率空间的声学映射（通常需要进行网格搜索，计算复杂度较高），还有一种替代方法是利用声强度进行定位。声强度定位方法在声源定位领域有着悠久的历史。在有利的声学条件下，声强度与声波传播方向平行，因此可以有效地估计声源的方向。然而，当存在声音反射时，声强度的准确性会迅速降低。

子空间方法是另一种经典的定位算法。这些方法依赖于计算（时间平均的）CPS矩阵R(f)，它定义为：
$$
R(f)=\sum_{n=1}^{N}X(f,n)X(f,n)^N
$$
其中$X(f,n)$是多通道信号向量的STFT（或更一般地是局部离散傅里叶变换），H表示共轭矩阵操作符）。通过对R(f)进行特征值分解（EVD），假设目标信号和噪声不相关，多信号分类（MUSIC）方法（Schmidt，1986）应用EVD来估计信号和噪声子空间。在公式(4)之后，信号子空间基向量被假设对应于混响矩阵A(f)的列向量，其中A(f)是源的多通道自适应滤波器（ATF）（在这个上下文中通常称为导向矢量）。然后，信号或噪声子空间基向量被用来探测给定方向上是否存在源，即应用空间滤波或波束形成（Benesty等，2008; Van Veen和Buckley，1988）。这个耗时的搜索可以通过利用信号子空间结构的Estimation of Signal Parameters via Rotational Invariance Technique (ESPRIT)算法（Roy和Kailath，1989）来放松，该算法直接推断源的方向。然而，相比于MUSIC，这通常会以产生较不准确的预测为代价（Mabande等，2011）。MUSIC和ESPRIT假设是窄带信号，虽然已经提出了宽带扩展（例如Dmochowski等，2007; Hogg et al.，2021）。子空间方法对噪声具有鲁棒性，可以产生高精度的估计结果，但对混响非常敏感。



## 奇怪的综述部分

例如，Dorfan和Gannot（2015）；Li等人（2017）；Mandel等人（2009）；May等人（2011）；Roman和Wang（2008）；Schwartz和Gannot（2013）；Woodruff和Wang（2012）提出了基于概率生成混合模型的方法。通常，这些模型是高斯混合模型（GMM）的变体，每个源信号或每个候选源位置对应一个高斯分量。在很少的论文中（例如May等人，2011），模型会使用专门的训练数据集进行离线训练。但大多数情况下，模型参数是直接在“测试时间”使用包含源信号的多通道信号进行估计的，通过最大化基于直方图的期望最大化（EM）算法来利用TF域中声源的稀疏性来最大化数据似然函数，这可能需要较大的计算量（Rickard，2002）。用于单源定位的GMM变体可直接通过回归模式进行运行，即一种高斯混合回归（GMR）形式，由Deleforge和Horaud（2012）提出，并后来扩展到多源定位（可能还包括分离）（Deleforge等人，2013, 2015）。GMR是局部线性但全局非线性的，模型参数的估计是在离线训练数据上完成的。因此，这种方法的精神与基于DNN的SSL非常接近。训练时使用合成房间脉冲响应（RIR）卷积的白噪声信号。该方法已经证明对于比TF域中的噪声更稀疏的语音信号具有很好的泛化能力，这要归功于在每个TF时频格子中建模信号活动的潜在变量的使用。

混合模型与贝叶斯推断密切相关，贝叶斯推断考虑到给定观测数据后模型参数的后验分布（因此涉及到似然函数和模型参数的先验分布）。Escolano等人（2014）考虑在一个二麦克风阵列设置中，应用贝叶斯推断于拉普拉斯源混合模型，并使用GCC-PHAT特征。有趣的是，他们使用了两个层次的贝叶斯推断：一个用于估计NoS（即型的超参数），使用贝叶斯模型选择；另一个用于估计模型参数（因此对应的源方向角），使用后验分布估计。在这项工作中，所涉及的分布评估是通过采样技术的，例如马尔可夫链蒙特卡洛（MCMC）方法。Bush和Xiang（2018）在一个由两个叠加的、空间欠采样的均匀线性阵列（Vaidyanathan和Pal，2010）组成的互质阵列上进一步应用相同的方法，Landschoot和Xiang（2019）在球谐域中使用球面麦克风阵列采用了相同的方法（参见第五节）。