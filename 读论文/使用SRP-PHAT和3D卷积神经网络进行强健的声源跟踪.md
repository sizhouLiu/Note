# 使用SRP-PHAT和3D卷积神经网络进行强健的声源跟踪 

本文提出了一种基于著名的SRP-PHAT算法和三维卷积神经网络的新型单声源DOA估计和跟踪系统。它使用SRP-PHAT功率图作为完全卷积因果结构的输入特征，利用3D卷积层准确执行声源跟踪，即使在大多数最先进技术无法成功的高混响场景中也可以实现。与先前的方法不同，由于我们不使用双向循环层，且所有卷积层在时间维度上都是因果的，因此我们的系统可用于实时应用，并为每个新的SRP-PHAT地图提供新的DOA估计。为了训练模型，我们引入了一个新的过程，模拟随机轨迹，这在训练过程中是必要的，相当于具有高灵活性以修改其声学条件（如混响时间）的无限大小数据集。我们使用声学模拟和LOCATA数据集的实际记录，证明了我们系统的稳健性以及即使使用低分辨率的SRP-PHAT地图也能表现良好。

关键词—CNN，卷积神经网络，DOA，到达方向估计，麦克风阵列，SRP-PHAT，声源跟踪。特征分解[8]，甚至基于深度学习的技术 [9]，
\2) 基于波束形成的技术，例如SRP-PHAT [10]，[11]，通过搜索最大化波束形成器输出功率的方向，
\3) 包括基于窄带互相关矩阵特征值结构的MUSIC（多信号分类）[12]，[13]等次空间技术。

这些技术在计算复杂性和对抗噪声和混响等不良场景的稳健性方面有所不同。当它们需要处理非平稳信号时，比如语音，需要在它们之后使用跟踪算法，以利用源位置之间的时间相关性。

最近，一些基于深度神经网络（DNN）的方法已经提出。从最初的多层感知器（MLP）用于第一批提议[18]，[19]，它们的架构逐渐演变成更复杂的卷积神经网络[20]–[22]，可以共同执行DOA估计和跟踪。然而，尽管基于DNN的技术声称比传统方法更稳健，但它们使用的CNN可能不是最合适的，其中许多添加了非因果循环层，使它们无法用于实时应用。

在本文中，我们提出使用3D CNN在SRP-PHAT功率图上共同执行高混响房间中源的DOA估计和跟踪。我们提出了一个完全因果关系的技术，每个新的功率图提供一个新的DOA估计，通过多个逆境条件的模拟展示其稳健性。我们分析了SRP-PHAT功率图的分辨率如何影响我们的技术，并证明通过使用CNN，我们可以获得超过计算地图的搜索网格的分辨率。最后，我们将我们的模型应用到声源LOCalization And TrAcking（LOCATA）挑战 [23]数据集上，以展示经过模拟信号训练的模型在真实条件下使用实际录音的泛化能力。虽然我们专注于紧凑的阵列，并评估我们技术在一个安装在NAO机器人头部的12个麦克风阵列上的性能，但该技术可用于任何阵列几何形状。

值得一提的是，我们专注于始终有活动源的单声源场景；因此，我们的跟踪不需要处理数据关联、源的生成和消亡问题。对于单声源场景，生成和消亡问题可以轻松地通过语音。

其中N是阵列的传感器数，Xn(ω)是xn(t)的傅立叶变换，Gn(ω)是通道n的滤波器的频率响应，τn(θ)是从位置或方向θ到第n个传感器的时间延迟。
尽管直接实现（3）将具有较高的计算复杂度，但可以通过广义互相关函数计算。![image-20240320170531765](C:\Users\sz.L\AppData\Roaming\Typora\typora-user-images\image-20240320170531765.png)



$$
SRP_{out}(t) = \sum_{1}^{M} \sum_{2}^MGCC_{12}(t)
$$

$$
GCC_{12}(t) = \sum_{w}G(w)_1G(w)_2^*X_1(w,t)X_2(w,t)^*e^{jw(\tau_1-\tau_2)}
$$

![image-20240320170552482](C:\Users\sz.L\AppData\Roaming\Typora\typora-user-images\image-20240320170552482.png)

方程(4)，结合使用相位变换（PHAT）Gn(ω)=1/|Xn(ω)|，通常被称为SRP-PHAT算法[10]，[11]，它允许我们获得环的声功率图，其中最大值应该对应于源位置。
尽管SR-PHAT算法在鲁棒性和计算效率之间取得了良好的折衷，比大多数宽带子空间技术的计算成本更低，同时获得比两步TDOA基于技术更准确的结果，但仍存在一些问题。方程(4)的主要优点是，大部分的计算成本在计算GCC中，并且不随搜索空间增加而增加。然而，对于每个方向计算其总和，特别是如果需要从相邻采样插值Rnm(Δτnm(θ))，可能不容忽视；当搜索空间为二维时（例如球坐标的两个角度），或者甚至为三维时（例如XYZ坐标），这个问题变得更具挑战性。已经提出了一些搜索策略来减少需要计算的(4)的评估次数，以准确找到P(θ)最大值 [24]–[26]，但是，由于SRP-PHAT功率图的非凸性，某些场景下仍可能需要大量SRP-PHAT评估。在[26]、[27]中，提出修改(4)以计算来自空间区域而不是点的接收功率，以便可以在分辨率较低的地图上使用分层搜索策略。
正如我们在图1中所看到的，在信噪比高、混响低的有利场景中，SRP-PHAT功率图在声源的DOA处具有明显的最大值，这可以用于根据低分辨率地图获得良好的估计，但是当信噪比降低并且混响增加时，例如在图2的场景中，地图显示出几个可能被错误解释为声源DOA的局部最大值，特别是在使用低分辨率地图时。然而，在这些地图中，除了最大值之外，我们还可以观察到几种也与声源的DOA和混响相关的模式。

由于感兴趣信号的大多数信号（如语音或音乐）具有非平稳性质，因此在DOA估计后需要进行跟踪阶段，以利用源位置之间的时间相关性，并避免在信号功率较低或其自相关性使得功率图的最大值过宽的帧中出现不准确的估计。单源跟踪的算法通常基于卡尔曼滤波器[14]，[15]，尽管已经提出了更先进的技术来处理多个源，例如基于粒子滤波的技术。然而，在这些方法中，它们使用两步策略，当仅使用DOA估计进行跟踪时，可能会导致潜在信息丢失敏感性；例如，始终选择SRP-PHAT地图的绝对最大值，即使另一个局部最大值更接近先前的估计，我们为所有DOA估计分配相同的似然性，而其中一些对应于源较弱的帧中的更宽的最大值。将部分这些信息包含在跟踪算法中可能是可能的，但这将增加其复杂性和需要进行微调的参数数量。在[28]中，提出了一种共享信息的技术，该技术基于期望最大化进行了迭代DOA估计和基于粒子滤波的跟踪系统。在本文中，我们使用神经网络共同执行DOA估计和跟踪，因为它们已被证明在其他领域的多个端到端问题中具有出色的性能，例如计算机视觉或语音识别或合成。



三。深度神经网络进行DOA估计
最早将神经网络用于DOA估计的提议之一是[18]，其使用具有隐藏层的全连接感知器来从GCCs中获得DOA作为分类问题。自那时以来，已经有多种技术被提出。它们在输出格式、输入特征和网络架构等方面存在差异。

A. 输出格式
为了将DOA估计作为分类问题，我们首先需要定义一个方向网格，在该网格中可以找到源（类似于SRP-PHAT地图的分辨率），因此网络每个网格点都有一个输出。[18]中的网络有359个输出，因此它们的方位角估计具有最大1°的分辨率。然而，如果我们想要估计方位角和俯仰角（甚至是XYZ坐标），输出数量将大大增加，因此会增加计算复杂性和训练网络所需的数据集大小。
在[18]的一个脚注中声称，当他们尝试将DOA估计作为回归问题时，他们获得了更差的结果，而分类方法似乎是最流行的。但是，自[22]提出使用3个输出来估计一个指向源方向的单位向量后，几种模型都采用了这种方法；关于使用3个回归输出来推断直角坐标而不是使用2个直接获得方位角和仰角的优势的进一步研究可在[38]，[39]中找到。受到这些最近工作良好结果的启发，我们选择了跟随回归方法。

将DOA估计作为回归问题解决的主要缺点之一是，这会使估计多源的DOA变得更加困难。由于它们还会将源分类为几个类别，声音事件定位和检测（SELD）模型通常为每个源类别的回归输出，假设每个类别只有一个源可以同时活跃。另一种可能的方法可能是使用单源DOA估计器（如本文提出的）结合源消除技术，以迭代地找到多个源。

B. 输入特征和网络结构
最初，最常见的输入特征是每个传感器信号之间的GCC[18]，[33]，[34]，但我们还可以找到其他方法，例如使用空间协方差矩阵的特征向量[19]。在[42]中，我们提出使用低分辨率的SRP-PHAT地图，那时结合了全连接的感知器。最近，一些技术已经提出使用2D卷积网络对麦克风信号的频谱图进行处理，只使用相位信息[30]、幅度信息[32]或两者[22]、[31]、[35]；也有人提出一些转换，如使用倒谱图[21]或梅尔频谱图[37]。作为CNN输入提出的其他特征包括全景声强度向量[43]、原始音频样本[20]以及几种已提及的特征的组合[21]，[36]，[37]。
CNN的一个最重要特性是它们对于平移是等变的，简而言之，这意味着如果我们对输入特征进行平移，将获得等效平移的相同输出。这一特性在DIAZ-GUERRA等人：使用SRP-PHAT和3D卷积神经网络进行稳健声源跟踪

许多计算机视觉应用程序中，相同模式在图像的所有位置具有相同的含义。在用于DOA估计和跟踪时，通常使用2D CNN在频谱图上进行卷积，因此卷积在时间和频率轴上执行，并且将每个麦克风频谱图视为不同的通道。对于时间平移具有等变性似乎是一个优势，因为我们期望任何位置的任何源在该位置时刻的模式相似。然而，由于同一源位置的相位差随频率变化，对频率变化具有等变性可能并不是一个有趣的属性。在[30]中提出了另一种使用2D CNN的方法，在该方法中，卷积在频率和麦克风维度上执行，并且网络不考虑时间演变，即它们不执行任何跟踪。由于他们使用均匀线性阵列(ULA)，所期望的源位置的相位差对于每对相邻麦克风是相同的，因此希望具有等变性，但对于其他阵列几何形状来说则并非如此。

在本文中，我们提出使用CNN在SRP-PHAT功率图上，通过在地图和时间维度上执行卷积。根据阵列的几何形状，可以使用任何类型的SRP-PHAT功率图，但由于我们专注于紧凑阵列，我们使用2D球形功率图，因此，由于包括时间维度，我们使用3D CNN。实际上，在球形地图上工作时，与球形平移(即旋转)具有等变性将优于欧几里德平移等变性，但这将导致使用球形CNN，从计算的角度看，球形CNN仍不如传统CNN效率高。扩展到4D CNN在3D SRP-PHAT地图上，可以执行使用分布式阵列进行3D声源定位（SSL）。

许多最先进的CNN架构在模型的最后几层包括双向递归单元。递归神经网络（RNNs）作为递归线性过滤器，使得任何时刻的输出都依赖于每个先前时刻的输入值，因此在反向方向应用它们是极端非因果的。显然，任何跟踪系统都可以从源的未来位置信息中获益良多，但为了使我们的系统适用于实时应用，我们选择仅使用因果卷积层。

IV. 提议的技术
A. 训练数据集
由于难以获得使用麦克风阵列记录的移动源的准确手工标记数据集，我们选择用模拟信号训练我们的模型；另一种方法可能是使用测得的RIRs与语音信号卷积，但这将减少模型在训练过程中看到的不同声学条件的数量，增加过拟合这些条件且不能泛化的可能性。我们不是生成一个数据集并使用它来训练网络，而是根据训练过程中需要的方式模拟网络的输入。这使训练变慢，但具有两个重要优点：1）我们有一个无限大小的数据集，因为在训练过程中针对每个模拟轨迹修改了模拟的所有随机参数，这降低了过拟合风险； 2）我们有更高的灵活性，可以在训练过程中修改模拟参数的概率分布，如信噪比或混响时间，以便可以执行课程学习策略。
如图3所示，我们使用LibriSpeech语音作为声源。LibriSpeech语料库[46]包含提取自有声书的以fs = 16 kHz采样的960小时的语音。虽然预期有声书可能包含相当干净的语音信号，但我们发现其中一些含有很强的

背景噪声，经过RIRs滤波后，将位于与源相同的位置，并且在安静片段中将有助于对其进行定位和跟踪。为了避免我们的网络学习利用这一点，而这在实际录音中是不存在的，我们使用WebRTC语音活动检测器(VAD) [47]来检测安静片段并通过完全去除这些帧中的信号来清理它们。
房间的大小是随机选择的，范围从3 × 3 × 2.5米到10 × 8 × 6米，阵列随机放置在房间内，受限于在每个维度上距离墙壁的分离为房间尺寸的10%，并且在垂直轴上位于房间的下半部分。信噪比（SNR）和混响时间（T60）也是从范围5 dB到30 dB和0.2秒到1.3秒中随机选择的。对于数据集的所有随机参数，都使用指定范围内的均匀分布。
我们需要随机生成连续的轨迹点，以便可以跟踪它们，但又具有足够的多样性，避免网络学习它们是如何生成的并对此进行过拟合。为了做到这一点，我们随机选择房间边界内的两点作为轨迹的起始点（p0 = [px0, py0, pz0]T）和终点（pL = [pxL, pyL, pzL]T），并在连接它们的直线上添加正弦函数，每个轴上具有随机频率（ω = [ωx, ωy, ωz]T）和振幅（A = [Ax, Ay, Az]T），以确保每个轴在轨迹中执行的振荡不超过2次，并且振幅足够低，以避免源离开房间。